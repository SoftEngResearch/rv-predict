According to ISO C11, it is undefined behavior to call va_start or va_copy to initialize a va_list without calling va_end on the same va_list prior to return from the function. In practice this can lead to failing to clean up the va_list which can in turn lead to accessing memory incorrectly and exposing memory to the user. The correct solution is to always call va_end on every va_list that was initialized by the current function prior to returning from the function.
