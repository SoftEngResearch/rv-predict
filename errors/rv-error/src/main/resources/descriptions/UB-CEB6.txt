According to ISO C11, it is undefined to perform a bitwise right shift with a negative second operand. The behavior of such a shift operation is architecture specific and depends on the code generated for the shift expression, and is therefore not portable and may trigger incorrect behavior on some platforms. The portable solution if the second operand could be negative is to test whether the operand is positive or negative, and if it is negative, perform a left shift instead of a right shift.
