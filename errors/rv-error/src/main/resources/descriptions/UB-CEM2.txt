According to ISO C11, it is undefined behavior to access the fields of an atomic union. This is because the layout of atomic unions may be different from the layout of the equivalent nonatomic type, and if individual fields are accessed directly, atomicity is not guaranteed. The correct solution is to either make the union nonatomic, or, if atomicity is required, to use the relevant constructs from stdatomic.h to copy the union into a nonatomic local variable and access the fields of the copy.
