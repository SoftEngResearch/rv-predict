<?xml version="1.0" encoding="UTF-8"?>
<project name="rv-replayer" default="run-replay">
    <taskdef resource="net/sf/antcontrib/antlib.xml">
        <classpath>
            <pathelement location="lib/ant-contrib.jar"/>
        </classpath>
    </taskdef>
	<property name="replay.main.class" value="edu.uiuc.run.Main"/>
	<property name="app.main.class" value="demo.Example"/>
	<!--
	stringbuffer.StringBufferTest
	emp.Simple
	causal.Main
	reentrantlock.Main
	causal.Main
	-->

	<property name="file.list" value="1,2"/>
	    <!-- 
	    ,5,6,7,8,9,10,11,12,13,14,15,16,17,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110
	     -->
	<property name="rv-predict-engine.home" location="${user.home}/workspace/rv-predict-engine"/>
	<property name="rv-predict-inst.home" location="${user.home}/workspace/rv-predict-inst"/>
	
	    	
   <target name="run-once">    			
    	    	<java classname="${replay.main.class}" fork="true" maxmemory="1000m">
    	    	 	<arg value="${file.number}"/>
    	            <classpath>
    	            	<pathelement location="${user.dir}/bin"/>
    	            </classpath>
    	        </java>        	
   </target>
	
	<target name="run-replay">
		<stopwatch name="timer" action="start"/>
		<for param="number" list="${file.list}"><!-- <antcall target="run-once"/> -->
			
		  <sequential>
		  	<echo message="run: @{number}"/>		  	
	    	<java classname="${replay.main.class}" fork="true" maxmemory="1500m">
	    	 	<arg value="${app.main.class}"/>
	    		<arg value="@{number}"/>
	            <classpath>
	            	<pathelement location="${user.dir}/bin"/>
	            	<pathelement location="${rv-predict-inst.home}/tmp/replay"/>

	            	<pathelement location="${rv-predict-engine.home}/bin"/>	            	
	            	<pathelement location="${rv-predict-engine.home}/lib/h2-1.3.171.jar"/>


	            	<!--
					-->
	            		            	     
	            </classpath>
	        </java>

		  </sequential>
		</for>
		<stopwatch name="timer" action="total"/>
		<echo message="run: ${timer}"/>
    </target>

</project>

